---
- hosts: all
  become: true
  gather_facts: false
  pre_tasks:
  - raw: test -e /usr/bin/python || (apt -y update && apt install -y python-minimal)
  - setup: # aka gather_facts

  tasks:
    - name: Check the VM can be contacted
      action: ping

- include: roles/install-docker/tasks/main.yaml
- include: roles/copy-client-resources/tasks/main.yaml
- include: roles/update-packages/tasks/main.yaml
- include: roles/start-server/tasks/main.yaml
- include: roles/obtain-certificates/tasks/main.yaml
